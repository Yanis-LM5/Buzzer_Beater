<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BB News</title>
    <link rel="stylesheet" href="style_teams.css"/>
    <link rel="shortcut icon" href="logo_bb.png" type="image/x-icon">
    <script src="https://kit.fontawesome.com/3ca4fe2b8a.js"></script>
</head>
<body>
<header>
    <input type="checkbox" id="check">
    <label for="check" class="checkbox">&#9776;</label>
    <nav class="navbar">
        <ul>
            <li><img src="logo_bb.png" alt="logo"></li>
            <li><a href="bb_menu.html">Home</a></li>
            <li><a href="bb_news.html">News</a></li>
            <li><a href="bb_teams.html">Teams</a></li>
            <li>Results</li>
            <li>Map</li>
            <li>Message</li>
            <li>Connect</li>
        </ul>
    </nav>
</header>

<main id="news-container">
    <h1>BB News</h1>
</main>

<script>
const url = "https://corsproxy.io/?https://rmcsport.bfmtv.com/rss/basket/nba/";

async function getArticles(url) {
    try {
        const res = await fetch(url);
        const text = await res.text();

        const parser = new DOMParser();
        const xmlDoc = parser.parseFromString(text, "text/xml");
        const items = xmlDoc.getElementsByTagName("item");

        const container = document.getElementById("news-container");
        container.style.display = "flex";
        container.style.flexDirection = "column";
        container.style.alignItems = "center";
        container.style.paddingTop = "60px"; // pour ne pas cacher sous le header

        for (let i = 0; i < items.length; i++) {
            const item = items[i];

            const articleDiv = document.createElement("div");
            articleDiv.classList.add("article"); // <-- utilise le style CSS intégré

            const title = document.createElement("h3");
            title.textContent = item.querySelector("title").textContent;
            articleDiv.appendChild(title);

            const enclosure = item.querySelector("enclosure");
            if (enclosure) {
                const img = new Image();
                img.src = enclosure.getAttribute("url");
                articleDiv.appendChild(img);
            }

            const date = document.createElement("p");
            date.classList.add("rss-date");
            const pubDate = item.querySelector("pubDate");
            if(pubDate) date.textContent = new Date(pubDate.textContent).toLocaleString();
            articleDiv.appendChild(date);

            const desc = document.createElement("p");
            const rawDesc = item.querySelector("description")?.textContent || "";
            desc.textContent = rawDesc.split("<")[0]; // enlève le HTML
            articleDiv.appendChild(desc);

            container.appendChild(articleDiv);
        }
    } catch (err) {
        console.error("Erreur fetch RSS :", err);
        const container = document.getElementById("news-container");
        container.innerHTML += "<p>Impossible de charger les news pour le moment.</p>";
    }
}

getArticles(url);
</script>
</body>
</html>